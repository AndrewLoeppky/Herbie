
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Herbie API &#8212; HRRR-B 0.0.1 documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/brian_style.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://kit.fontawesome.com/f6cc126dcc.js"></script>
    <link rel="shortcut icon" href="../_static/wxicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="HRRR-B API" href="hrrrb_api.html" />
    <link rel="prev" title="Reference Guide" href="index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/Herbie_Logo.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../user_guide/index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  Reference Guide
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://blaylockbk.github.io/SynopticPy/_build/html/">SynopticPy<i class="fas fa-external-link-alt"></i></a>
    </li>
    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://blaylockbk.github.io/goes2go/_build/html/">GOES-2-go<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/blaylockbk/HRRR_archive_download" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/blaylockbk" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
      <div class="navbar-end-item">
        <form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Herbie API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hrrrb_api.html">
   HRRR-B API
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#herbie-download-hrrr-and-rap-model-output-from-the-cloud">
   Herbie: Download HRRR and RAP model output from the cloud
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hrrr-and-rap-data-sources">
     HRRR and RAP Data Sources
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#herbie-extension-xarray-accessors">
   Herbie Extension: xarray accessors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#herbie-tools">
   Herbie Tools
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                

<div class="tocsection editthispage">
    <a href="https://github.com/blaylockbk/HRRR_archive_download/edit/master/docs/reference_guide/herbie_api.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="module-herbie.archive">
<span id="herbie-api"></span><h1>Herbie API<a class="headerlink" href="#module-herbie.archive" title="Permalink to this headline">¬∂</a></h1>
<div class="section" id="herbie-download-hrrr-and-rap-model-output-from-the-cloud">
<h2>Herbie: Download HRRR and RAP model output from the cloud<a class="headerlink" href="#herbie-download-hrrr-and-rap-model-output-from-the-cloud" title="Permalink to this headline">¬∂</a></h2>
<p>Herbie is your model output download assistant with a mind of his own!
Herbie might look small on the outside, but he has a big heart on the
inside and will get you to the
<a class="reference external" href="https://www.youtube.com/watch?v=4XWufUZ1mxQ&amp;t=189s">finish line</a> üèÅ.</p>
<p>With Herbie‚Äôs API, you can download High-Resolution Rapid Refresh (HRRR)
HRRR-Alaska, and Rapid Refresh (RAP) model GRIB2 files from different
archive sources. Supports subsetting of GRIB2 files by individual GRIB
messages (i.e. variable and level) if the index (.idx) file exist.
Herbie looks for model output data from NOMADS, NOAA‚Äôs Big Data Project
partners (Amazon Web Services, Google Cloud Platform, and Microsoft
Azure), and the CHPC Pando archive at the University of Utah.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Updates since <code class="docutils literal notranslate"><span class="pre">hrrrb</span></code></p>
<ul class="simple">
<li><p>Rename package to <code class="docutils literal notranslate"><span class="pre">herbie</span></code>. ‚ÄúHerbie is your model output download assistant with a mind of its own.‚Äù</p></li>
<li><p>Implement new <strong>Herbie</strong> class</p></li>
<li><p>Drop support for hrrrx (experimental HRRR no longer archived on Pando and ESRL is now developing RRFS)</p></li>
<li><p>Added ability to download and read RAP model GRIB2 files.</p></li>
<li><p>Less reliance on Pando, more on aws and google.</p></li>
<li><p>New method for searchString index file search. Uses same regex search patterns as old API.</p></li>
<li><p>Filename for GRIB2 subset includes all GRIB message numbers.</p></li>
<li><p>Moved default download source to config file setting.</p></li>
<li><p>Check local file copy on __init__. (Don‚Äôt need to look for file on remote if we have local copy)</p></li>
<li><p>Option to remove grib2 file when reading xarray if didn‚Äôt already exist locally (don‚Äôt clutter local disk).</p></li>
<li><p>Attach index file DataFrame to object if it exists.</p></li>
<li><p>If full file exists locally, use remote idx file to cURL local file instead of remote. (Can‚Äôt create idx file locally because wgrib2 not available on windows)</p></li>
<li><p>TODO: Rename ‚ÄòsearchString‚Äô to ‚Äòsubset‚Äô (and rename subset function)</p></li>
<li><p>TODO: Add NCEI as a source for the RAP data?? URL is complex.</p></li>
<li><p>TODO: Create .idx file if wgrib2 is installed (linux only)</p></li>
</ul>
</div>
<div class="section" id="hrrr-and-rap-data-sources">
<h3>HRRR and RAP Data Sources<a class="headerlink" href="#hrrr-and-rap-data-sources" title="Permalink to this headline">¬∂</a></h3>
<p>Real-time HRRR and RAP data is available from NOMADS. At the end of
2020, NOAA started pushing the HRRR and RAP data to the Google Cloud
Platform and Amazon Web Services as part of the NOAA Big Data Progam.
These archives were backfilled to previous years as far back as
July 30, 2014. A archive used for research purposes also exists
on the University of Utah CHPC Pando Archive System.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A paper about archiving model data in the cloud.</p>
<p>Blaylock B., J. Horel and S. Liston, 2017: Cloud Archiving and Data
Mining of High Resolution Rapid Refresh Model Output. Computers and
Geosciences. 109, 43-50. <a class="reference external" href="https://doi.org/10.1016/j.cageo.2017.08.005">https://doi.org/10.1016/j.cageo.2017.08.005</a></p>
</div>
<p>The Herbie module enables you to easily download HRRR and RAP data
between these different data sources wherever the data you are
interested in is available. The different download sources and the
download priority order are listed below:</p>
<ol class="arabic simple">
<li><dl class="simple">
<dt>AWS: Amazon Web Services</dt><dd><ul class="simple">
<li><p><a class="reference external" href="https://noaa-hrrr-bdp-pds.s3.amazonaws.com/">https://noaa-hrrr-bdp-pds.s3.amazonaws.com/</a></p></li>
<li><p>Available from July 30, 2014 to Present.</p></li>
<li><p>Slight latency for real-time products.</p></li>
<li><p>Not all GRIB2 files have an .idx files.</p></li>
<li><p>Has all nat, subh, prs, and sfc files for all forecast hours.</p></li>
<li><p>Some data may be missing.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>NOMADS: NOAA Operational Model Archive and Distribution System</dt><dd><ul class="simple">
<li><p><a class="reference external" href="https://nomads.ncep.noaa.gov/">https://nomads.ncep.noaa.gov/</a></p></li>
<li><p>Available for today‚Äôs and yesterday‚Äôs runs</p></li>
<li><p>Real-time data.</p></li>
<li><p>Original data source. All available data included.</p></li>
<li><p>Download limits.</p></li>
<li><p>Includes GRIB2 .idx for all GRIB2 files.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Google: Google Cloud Platform Earth</dt><dd><ul class="simple">
<li><p><a class="reference external" href="https://console.cloud.google.com/storage/browser/high-resolution-rapid-refresh">https://console.cloud.google.com/storage/browser/high-resolution-rapid-refresh</a></p></li>
<li><p>Available from July 30, 2014 to Present.</p></li>
<li><p>Slight latency for real-time products.</p></li>
<li><p>Does not have GRIB2 .idx files before September 17, 2018.</p></li>
<li><p>Has all original data including nat, subh, prs, and sfc files
for all forecast hours.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Azure: Microsoft Azure</dt><dd><ul class="simple">
<li><p><a class="reference external" href="https://github.com/microsoft/AIforEarthDataSets/blob/main/data/noaa-hrrr.md">https://github.com/microsoft/AIforEarthDataSets/blob/main/data/noaa-hrrr.md</a></p></li>
<li><p>Only recent HRRR and RAP data?</p></li>
<li><p>Subset of HRRR and RAP data?</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Pando: The University of Utah HRRR archive</dt><dd><ul class="simple">
<li><p><a class="reference external" href="http://hrrr.chpc.utah.edu/">http://hrrr.chpc.utah.edu/</a></p></li>
<li><p>Research archive. Older files being removed.</p></li>
<li><p>A subset of prs and sfc files.</p></li>
<li><p>Contains .idx file for every GRIB2 file.</p></li>
</ul>
</dd>
</dl>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Default Download Priority Rational</strong>
Most often, a user will request model output from a recent
past or earlier run. Past data is archived at one of NOAA‚Äôs Big
Data parters. NOMADS has the most recent model output available,
but they also throttle the download speed and will block users who
violate their usage agreement and download too much data within
an hour. To prevent being blocked by NOMADS, the default is to
first look for data on AWS. If the data requested is within the
last few hours and was not found on AWS, then Herbie will look
for the data at NOMADS. If you really want to download data
from NOMADS and not a Big Data Project partner, change the
priority order so that NOMADS is first, (e.g.,
<code class="docutils literal notranslate"><span class="pre">priority=['nomads',</span> <span class="pre">...]</span></code>).</p>
</div>
<p><strong>Classes:</strong></p>
<table class="longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#herbie.archive.Herbie" title="herbie.archive.Herbie"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Herbie</span></code></a>(DATE[,¬†fxx,¬†model,¬†field,¬†priority,¬†‚Ä¶])</p></td>
<td><p>Find model output file location based on source priority.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="herbie.archive.Herbie">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">herbie.archive.</span></span><span class="sig-name descname"><span class="pre">Herbie</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">DATE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hrrr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sfc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['aws',</span> <span class="pre">'nomads',</span> <span class="pre">'google',</span> <span class="pre">'azure',</span> <span class="pre">'pando',</span> <span class="pre">'pando2']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PosixPath('/p/cwfs/blaylock/data')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DATE_is_valid_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#herbie.archive.Herbie" title="Permalink to this definition">¬∂</a></dt>
<dd><p>Find model output file location based on source priority.</p>
<p><strong>Methods:</strong></p>
<table class="longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#herbie.archive.Herbie.__init__" title="herbie.archive.Herbie.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(DATE[,¬†fxx,¬†model,¬†field,¬†‚Ä¶])</p></td>
<td><p>Specify model output and find GRIB2 file at one of the sources.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#herbie.archive.Herbie.download" title="herbie.archive.Herbie.download"><code class="xref py py-obj docutils literal notranslate"><span class="pre">download</span></code></a>([searchString,¬†source,¬†save_dir,¬†‚Ä¶])</p></td>
<td><p>Download file from source.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#herbie.archive.Herbie.get_localPath" title="herbie.archive.Herbie.get_localPath"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_localPath</span></code></a>([searchString])</p></td>
<td><p>Get path to local file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#herbie.archive.Herbie.get_url" title="herbie.archive.Herbie.get_url"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_url</span></code></a>(source)</p></td>
<td><p>Build the URL for the GRIB2 file for the requested file and data source.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#herbie.archive.Herbie.read_idx" title="herbie.archive.Herbie.read_idx"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_idx</span></code></a>([searchString])</p></td>
<td><p>Inspect the GRIB2 file contents by reading the index file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#herbie.archive.Herbie.xarray" title="herbie.archive.Herbie.xarray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xarray</span></code></a>(searchString[,¬†backend_kwargs,¬†‚Ä¶])</p></td>
<td><p>Open GRIB2 data as xarray DataSet</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#herbie.archive.Herbie.get_localFileName" title="herbie.archive.Herbie.get_localFileName"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_localFileName</span></code></a></p></td>
<td><p>Predict Local File Name</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#herbie.archive.Herbie.get_remoteFileName" title="herbie.archive.Herbie.get_remoteFileName"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_remoteFileName</span></code></a></p></td>
<td><p>Predict Remote File Name</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="herbie.archive.Herbie.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">DATE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hrrr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sfc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['aws',</span> <span class="pre">'nomads',</span> <span class="pre">'google',</span> <span class="pre">'azure',</span> <span class="pre">'pando',</span> <span class="pre">'pando2']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PosixPath('/p/cwfs/blaylock/data')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DATE_is_valid_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#herbie.archive.Herbie.__init__" title="Permalink to this definition">¬∂</a></dt>
<dd><p>Specify model output and find GRIB2 file at one of the sources.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DATE</strong> (<em>pandas-parsable datetime</em>) ‚Äì Model initialization datetime if
<code class="docutils literal notranslate"><span class="pre">DATE_is_valid_time=False</span></code> (default) or forecast valid
datetime if <code class="docutils literal notranslate"><span class="pre">DATE_is_valid_time=True</span></code>.</p></li>
<li><p><strong>fxx</strong> (<em>int</em>) ‚Äì Forecast lead time in hours. Available lead times depend on
the model type and model version. Range from 0 to 15, 18,
36, or 48 (model and run dependant).</p></li>
<li><p><strong>model</strong> (<em>{'hrrr'</em><em>, </em><em>'hrrrak'</em><em>, </em><em>'rap'}</em>) ‚Äì Model type.
- <code class="docutils literal notranslate"><span class="pre">'hrrr'</span></code> HRRR contiguous United States model
- <code class="docutils literal notranslate"><span class="pre">'hrrrak'</span></code> HRRR Alaska model (alias <code class="docutils literal notranslate"><span class="pre">'alaska'</span></code>)
- <code class="docutils literal notranslate"><span class="pre">'rap'</span></code> RAP model</p></li>
<li><p><strong>field</strong> (<em>{'sfc'</em><em>, </em><em>'prs'</em><em>, </em><em>'nat'</em><em>, </em><em>'subh'}</em>) ‚Äì Output variable field file type. In the HRRR model, the
different field files have certain variables at levels.
Not required for the RAP model as all variables are in the
same file.
- <code class="docutils literal notranslate"><span class="pre">'sfc'</span></code> surface fields
- <code class="docutils literal notranslate"><span class="pre">'prs'</span></code> pressure fields
- <code class="docutils literal notranslate"><span class="pre">'nat'</span></code> native fields
- <code class="docutils literal notranslate"><span class="pre">'subh'</span></code> subhourly fields</p></li>
<li><p><strong>priority</strong> (<em>list</em><em> or </em><em>str</em>) ‚Äì List of model sources to get the data in the order of
download priority. The available data sources and default
priority order are listed below.
- <code class="docutils literal notranslate"><span class="pre">'aws'</span></code> Amazon Web Services (Big Data Program)
- <code class="docutils literal notranslate"><span class="pre">'nomads'</span></code> NOAA‚Äôs NOMADS server
- <code class="docutils literal notranslate"><span class="pre">'google'</span></code> Google Cloud Platform (Big Data Program)
- <code class="docutils literal notranslate"><span class="pre">'azure'</span></code> Microsoft Azure (Big Data Program)
- <code class="docutils literal notranslate"><span class="pre">'pando'</span></code> University of Utah Pando Archive (gateway 1)
- <code class="docutils literal notranslate"><span class="pre">'pando2'</span></code> University of Utah Pando Archive (gateway 2)</p></li>
<li><p><strong>save_dir</strong> (<em>str</em><em> or </em><em>pathlib.Path</em>) ‚Äì Location to save GRIB2 files locally. Default save directory
is set in <code class="docutils literal notranslate"><span class="pre">~/.config/herbie/config.cfg</span></code>.</p></li>
<li><p><strong>DATE_is_valid_time</strong> (<em>bool</em>) ‚Äì If True, DATE represents the valid time.
If False (default), DATE represents the initialization time.</p></li>
<li><p><strong>Overwrite</strong> (<em>bool</em>) ‚Äì If True, look for GRIB2 files even if local copy exists.
If False (default), use the local copy (still need to find
the idx file).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="herbie.archive.Herbie.download">
<span class="sig-name descname"><span class="pre">download</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">searchString</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'warn'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#herbie.archive.Herbie.download" title="Permalink to this definition">¬∂</a></dt>
<dd><p>Download file from source.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>searchString</strong> (<em>str</em>) ‚Äì If None, download the full file. Else, use regex to subset
the file by specific variables and levels.</p></li>
<li><p><strong>source</strong> (<em>{'nomads'</em><em>, </em><em>'aws'</em><em>, </em><em>'google'</em><em>, </em><em>'azure'</em><em>, </em><em>'pando'</em><em>, </em><em>'pando2'}</em>) ‚Äì If None, download GRIB2 file from self.grib2 which is
the first location the GRIB2 file was found from the
priority lists when this class was initialized. Else, you
may specify the source to force downloading it from a
different location.</p></li>
<li><p><strong>save_dir</strong> (<em>str</em><em> or </em><em>pathlib.Path</em>) ‚Äì Location to save the model output files.
If None, uses the default or path specified in __init__.
Else, changes the path files are saved.</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em>) ‚Äì If True, overwrite existing files. Default will skip
downloading if the full file exists. Not applicable when
when searchString is not None because file subsets might
be unique.</p></li>
<li><p><strong>errors</strong> (<em>{'warn'</em><em>, </em><em>'raise'}</em>) ‚Äì When an error occurs, send a warning or raise a value error.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="herbie.archive.Herbie.get_localFileName">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">get_localFileName</span></span><a class="headerlink" href="#herbie.archive.Herbie.get_localFileName" title="Permalink to this definition">¬∂</a></dt>
<dd><p>Predict Local File Name</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="herbie.archive.Herbie.get_localPath">
<span class="sig-name descname"><span class="pre">get_localPath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">searchString</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#herbie.archive.Herbie.get_localPath" title="Permalink to this definition">¬∂</a></dt>
<dd><p>Get path to local file</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="herbie.archive.Herbie.get_remoteFileName">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">get_remoteFileName</span></span><a class="headerlink" href="#herbie.archive.Herbie.get_remoteFileName" title="Permalink to this definition">¬∂</a></dt>
<dd><p>Predict Remote File Name</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="herbie.archive.Herbie.get_url">
<span class="sig-name descname"><span class="pre">get_url</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#herbie.archive.Herbie.get_url" title="Permalink to this definition">¬∂</a></dt>
<dd><p>Build the URL for the GRIB2 file for the requested file and data source.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>source</strong> (<em>{'aws'</em><em>, </em><em>'nomads'</em><em>, </em><em>'google'</em><em>, </em><em>'azure'</em><em>, </em><em>'pando'</em><em>, </em><em>'pando2'}</em>) ‚Äì The data download source for the RAP and HRRR models.
- <code class="docutils literal notranslate"><span class="pre">'aws'</span></code> Amazon Web Services (Big Data Program)
- <code class="docutils literal notranslate"><span class="pre">'nomads'</span></code> NOAA‚Äôs NOMADS server
- <code class="docutils literal notranslate"><span class="pre">'google'</span></code> Google Cloud Platform (Big Data Program)
- <code class="docutils literal notranslate"><span class="pre">'azure'</span></code> Microsoft Azure (Big Data Program)
- <code class="docutils literal notranslate"><span class="pre">'pando'</span></code> University of Utah Pando Archive (gateway 1)
- <code class="docutils literal notranslate"><span class="pre">'pando2'</span></code> University of Utah Pando Archive (gateway 2)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="herbie.archive.Herbie.read_idx">
<span class="sig-name descname"><span class="pre">read_idx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">searchString</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#herbie.archive.Herbie.read_idx" title="Permalink to this definition">¬∂</a></dt>
<dd><p>Inspect the GRIB2 file contents by reading the index file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>searchString</strong> (<em>str</em>) ‚Äì Filter dataframe by a searchString regular expression.
Searches for strings in the index file lines, specifically
the variable, level, and forecast_time columns.
Execute <code class="docutils literal notranslate"><span class="pre">_searchString_help()</span></code> for examples of a good
searchString.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A Pandas DataFrame of the index file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="herbie.archive.Herbie.xarray">
<span class="sig-name descname"><span class="pre">xarray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">searchString</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_grib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">download_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#herbie.archive.Herbie.xarray" title="Permalink to this definition">¬∂</a></dt>
<dd><p>Open GRIB2 data as xarray DataSet</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>searchString</strong> (<em>str</em>) ‚Äì Variables to read into xarray Dataset</p></li>
<li><p><strong>remove_grib</strong> (<em>bool</em>) ‚Äì If True, grib file will be removed ONLY IF it didn‚Äôt exist
before we downloaded it.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<span class="target" id="module-herbie.accessors"></span><div class="section" id="herbie-extension-xarray-accessors">
<h2>Herbie Extension: xarray accessors<a class="headerlink" href="#herbie-extension-xarray-accessors" title="Permalink to this headline">¬∂</a></h2>
<p>Extend the xarray capabilities with a custom accessor.
<a class="reference external" href="http://xarray.pydata.org/en/stable/internals.html#extending-xarray">http://xarray.pydata.org/en/stable/internals.html#extending-xarray</a></p>
</div>
<span class="target" id="module-herbie.tools"></span><div class="section" id="herbie-tools">
<h2>Herbie Tools<a class="headerlink" href="#herbie-tools" title="Permalink to this headline">¬∂</a></h2>
<p><strong>Functions:</strong></p>
<table class="longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#herbie.tools.bulk_download" title="herbie.tools.bulk_download"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bulk_download</span></code></a>(DATES[,¬†searchString,¬†fxx,¬†‚Ä¶])</p></td>
<td><p>Bulk download GRIB2 files from file source to the local machine.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#herbie.tools.xr_concat_sameLead" title="herbie.tools.xr_concat_sameLead"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xr_concat_sameLead</span></code></a>(DATES,¬†searchString[,¬†‚Ä¶])</p></td>
<td><p>Load and concatenate xarray objects by model initialization date for the same lead time.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#herbie.tools.xr_concat_sameRun" title="herbie.tools.xr_concat_sameRun"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xr_concat_sameRun</span></code></a>(DATE,¬†searchString[,¬†fxx])</p></td>
<td><p>Load and concatenate xarray objects by forecast lead time for the same run.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="herbie.tools.bulk_download">
<span class="sig-prename descclassname"><span class="pre">herbie.tools.</span></span><span class="sig-name descname"><span class="pre">bulk_download</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">DATES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">searchString</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">range(0,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hrrr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sfc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#herbie.tools.bulk_download" title="Permalink to this definition">¬∂</a></dt>
<dd><p>Bulk download GRIB2 files from file source to the local machine.</p>
<p>Iterates over a list of datetimes (DATES) and forecast lead times (fxx).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DATES</strong> (<em>list</em>) ‚Äì List of datetimes</p></li>
<li><p><strong>searchString</strong> (<em>None</em><em> or </em><em>str</em>) ‚Äì If None, download the full file. If string, use regex to search
index files for variables and levels of interest and only
download the matched GRIB messages.</p></li>
<li><p><strong>fxx</strong> (<em>int</em><em> or </em><em>list</em>) ‚Äì List of forecast lead times to download. Default only downloads model analysis.</p></li>
<li><p><strong>model</strong> (<em>{'hrrr'</em><em>, </em><em>'hrrrak'</em><em>, </em><em>'rap'}</em>) ‚Äì Model to download.</p></li>
<li><p><strong>field</strong> (<em>{'sfc'</em><em>, </em><em>'prs'</em><em>, </em><em>'nat'</em><em>, </em><em>'subh'}</em>) ‚Äì Variable fields file to download. Not needed for RAP model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="herbie.tools.xr_concat_sameLead">
<span class="sig-prename descclassname"><span class="pre">herbie.tools.</span></span><span class="sig-name descname"><span class="pre">xr_concat_sameLead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">DATES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">searchString</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DATE_is_valid_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#herbie.tools.xr_concat_sameLead" title="Permalink to this definition">¬∂</a></dt>
<dd><p>Load and concatenate xarray objects by model initialization date for the same lead time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DATES</strong> (<em>list of pandas-parsable datetime</em>) ‚Äì Datetime that represents the model valid time.</p></li>
<li><p><strong>searchString</strong> (<em>str</em>) ‚Äì Variable fields to load. This really only works if the search
string returns data on the same hyper cube.</p></li>
<li><p><strong>fxx</strong> (<em>int</em>) ‚Äì The forecast lead time, in hours.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="herbie.tools.xr_concat_sameRun">
<span class="sig-prename descclassname"><span class="pre">herbie.tools.</span></span><span class="sig-name descname"><span class="pre">xr_concat_sameRun</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">DATE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">searchString</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">range(0,</span> <span class="pre">18)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#herbie.tools.xr_concat_sameRun" title="Permalink to this definition">¬∂</a></dt>
<dd><p>Load and concatenate xarray objects by forecast lead time for the same run.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DATE</strong> (<em>pandas-parsable datetime</em>) ‚Äì A datetime that represents the model initialization time.</p></li>
<li><p><strong>searchString</strong> (<em>str</em>) ‚Äì Variable fields to load. This really only works if the search
string returns data on the same hyper cube.</p></li>
<li><p><strong>fxx</strong> (<em>list of int</em>) ‚Äì List of forecast lead times, in hours, to concat together.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="index.html" title="previous page">Reference Guide</a>
    <a class='right-next' id="next-link" href="hrrrb_api.html" title="next page">HRRR-B API</a>

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-PT9LX1B7B8"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('config', 'G-PT9LX1B7B8');
                </script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, Brian K. Blaylock.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.0.2.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>